<?xml version="1.0" encoding="utf-8" ?>
<odoo>
    <data>
        <template id="print_invoice_page" name="page">
            <html>
                <head>
                    <script type="text/javascript">
                        function printPatientInvoice() {
                        var printer = window.open('left=0', 'top=0');
                        printer.document.open("text/html");
                        printer.document.write(document.getElementById('print_div').innerHTML);
                        printer.print();
                        printer.document.close();
                        printer.window.close();
                        printer.close();
                        window.close();
                        }
                    </script>

                </head>
                <body onload="printPatientInvoice()">
                    <t t-foreach="data" t-as="o">
                        <div class="container" id="print_div">

                            <style>
                                tr.border_bottom td {
                                border-bottom: 1px solid black;
                                }
                                tr.border_top td {
                                border-top: 1px solid black;
                                }
                                .mr{
                                margin-top:0px
                                }
                            </style>

                            <div class="page">

                                <!--                                <div style="padding-left:0px">-->
                                <!--                                    <img width="100%" src='/bahmni_sale/static/src/image/banner_.jpg'/>-->
                                <!--                                </div>-->

                                <!--                                <br/>-->
                                <!--                                <br/>-->

                                <div>
                                    <table style="width:100%; font-size:14px">
                                        <tr>
                                            <td colspan="3">
                                                <img style="width:100%"
                                                     src='/bahmni_sale/static/src/image/banner.jpg'/>
                                            </td>
                                        </tr>
                                    </table>

                                    <table style="width:100%; font-size:13px; text-align:left">

                                        <tr>
                                            <td style="font-weight:bold; width:18%">Invoice Number</td>
                                            <td style="width:1%">:</td>
                                            <td style="width:18%">
                                                <t t-esc="o.number"/>
                                            </td>
                                            <td style="font-weight:bold; width:20% ">Date and Time</td>
                                            <td style="width:1%">:</td>
                                            <td style="width:20%">
                                                <span t-esc="invoice_date"/>
                                            </td>

                                        </tr>
                                        <tr>
                                            <td style="font-weight:bold;">Patient ID</td>
                                            <td>:</td>
                                            <td>
                                                <t t-esc="o.partner_id.ref"/>
                                            </td>
                                            <td style="font-weight:bold;">Patient Name</td>
                                            <td>:</td>
                                            <td>
                                                <span t-field="o.partner_id.name"/>
                                            </td>
                                        </tr>

                                        <tr>
                                            <td style="font-weight:bold;">Age</td>
                                            <td>:</td>
                                            <td>
                                                <span t-esc="patientAge"/>
                                            </td>
                                            <td style="font-weight:bold;">Gender</td>
                                            <td>:</td>
                                            <td>
                                                <span t-esc="patientGender"/>
                                            </td>
                                        </tr>
                                    </table>
                                    <br/>
                                    <div>
                                        <table style="width:100%; font-size: 14px;">
                                            <tr class="border_bottom" style="font-weight:bold;" bgcolor="#eee">
                                                <td>S/N</td>
                                                <td align="left" width="60%">Services</td>
                                                <td>Quantity</td>
                                                <td>Unit Price</td>
                                                <td>Amount</td>
                                            </tr>
                                            <t t-set="total_sum" t-value="0"/>
                                            <tbody class="invoice_tbody">
                                                <tr t-foreach="invoiceLines" t-as="l">
                                                    <td>
                                                        <span t-esc="l_index+1"/>
                                                    </td>
                                                    <td>
                                                        <span t-field="l.name"/>
                                                    </td>
                                                    <td align="right">
                                                        <span t-field="l.quantity"/>
                                                    </td>
                                                    <td align="right">
                                                        <span t-field="l.price_unit"/>
                                                    </td>
                                                    <td align="right">
                                                        <span t-esc="'%.2f'%(l.price_unit*l.quantity)"/>
                                                        <t t-set="total_sum"
                                                           t-value="total_sum + (l.price_unit*l.quantity)"/>
                                                    </td>
                                                </tr>
                                                <tr align="right" style="font-weight:bold;font-size:16px"
                                                    class="border_top">
                                                    <td colspan="4">Total:</td>
                                                    <td align="right">
                                                        <t t-esc="'%.2f'%(total_sum)"/>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td align="right" style="font-weight:bold;font-size:16px"
                                                        colspan="4">Free:
                                                    </td>
                                                    <td align="right" style="font-size: 16px;">
                                                        <t t-esc="o.discount"/>
                                                    </td>
                                                </tr>
                                                <tr style="font-weight:bold;font-size:16px">
                                                    <td align="right" colspan="4">Paid Amount:
                                                    </td>
                                                    <td align="right" style="font-size: 16px;">
                                                        <t t-esc="o.amount_total - o.residual"/>
                                                        <t t-set="paid" t-value="o.amount_total - o.residual"></t>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td align="right" style="font-weight:bold;font-size:16px"
                                                        colspan="4">Due Amount:
                                                    </td>
                                                    <td align="right" style="font-size: 16px;">
                                                        <t t-esc="o.residual"/>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>

                                        <br/>
                                        <br/>
                                        <div>
                                            <p style="text-align:right;">
                                                <sapn style="border-bottom:1px solid black">
                                                    <t t-esc="o.write_uid.name"/>
                                                </sapn>
                                            </p>
                                            <p style="text-align:right;font-size: 16px;">Billing Clerk</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </t>
                    <xpath expr="." position="inside">
                        <link rel="import" href="//bahmni_sale/views/sale_order_views.xml"/>
                    </xpath>
                </body>
            </html>

        </template>
    </data>
</odoo>